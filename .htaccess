# .htaccess - URL Rewriting Configuration for Code to Crack

RewriteEngine On

# Force HTTPS (optional - uncomment if needed)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Remove trailing slashes (optional)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} (.+)/$
RewriteRule ^ %1 [R=301,L]

# Homepage - redirect index.html to root
RewriteCond %{THE_REQUEST} /index\.html[\s?] [NC]
RewriteRule ^index\.html$ / [R=301,L]

# Internal rewrite for root to index.html
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^$ index.html [L]

# Category pages without subcategory
# URL: /category-name/ -> category.html?category=category-name
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9\-]+)/?$ category.html?category=$1 [L,QSA]

# Category pages with subcategory
# URL: /category-name/subcategory-name/ -> category.html?category=category-name&subcategory=subcategory-name
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9\-]+)/([a-zA-Z0-9\-]+)/?$ category.html?category=$1&subcategory=$2 [L,QSA]

# Blog post pages
# URL: /category/subcategory/post-slug -> blog-single.html?slug=post-slug&category=category&subcategory=subcategory
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9\-]+)/([a-zA-Z0-9\-]+)/([a-zA-Z0-9\-]+)/?$ blog-single.html?category=$1&subcategory=$2&slug=$3 [L,QSA]

# Handle direct file access (prevent bypassing clean URLs)
# Redirect old URLs to new clean URLs
RewriteCond %{THE_REQUEST} \s/+category\.html\?category=([^&\s]+)&subcategory=([^&\s]+) [NC]
RewriteRule ^ /%1/%2/? [R=301,L]

RewriteCond %{THE_REQUEST} \s/+category\.html\?category=([^&\s]+) [NC]
RewriteRule ^ /%1/? [R=301,L]

RewriteCond %{THE_REQUEST} \s/+blog-single\.html\?.*slug=([^&\s]+) [NC]
RewriteRule ^ /post/%1/? [R=301,L]

# Admin panel - keep original URLs
RewriteRule ^admin/ - [L]
RewriteRule ^admin-login\.html$ - [L]
RewriteRule ^admin-panel\.html$ - [L]

# Static files - allow direct access
RewriteRule ^(css|js|images|fonts|widgets)/.*$ - [L]

# Search page - keep original functionality
RewriteRule ^search\.html$ - [L]

# Error handling
ErrorDocument 404 /404.html

# Cache control for better performance
<IfModule mod_expires.c>
    ExpiresActive on
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
</IfModule>